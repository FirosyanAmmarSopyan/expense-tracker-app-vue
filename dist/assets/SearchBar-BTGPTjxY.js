import{_ as he}from"./ChangeModal-CwCIfM9c.js";import{Q as _e,r as t,u as we,c as $,ac as xe,o as be,w as P,b as l,k as d,g as c,f as r,h as p,N as L,ah as ke,i as n,e as f,m as y,F as G,l as Se,ai as Ce,I as ze,t as A,a1 as Te,p as j,aj as Fe,ak as De,af as Be,al as Ne,a5 as Re,B as $e,am as Le,a2 as Me,D as Ie}from"./vendor-B24ldFEr.js";import{_ as Ve,a as Ee}from"./index-BUXYj-sS.js";const Pe={style:{width:"100%"}},Ae=["onClick"],je={style:{display:"flex",gap:"0.5rem","align-items":"center","justify-content":"space-between"}},qe={key:0,class:"paragraph-11-regular",style:{"white-space":"nowrap",color:"#a7a7ad"}},Ue={key:0,style:{display:"flex","align-items":"center",gap:"0.5rem","padding-right":"1rem"}},Oe={class:"paragraph-11-regular",style:{"white-space":"nowrap",color:"#a7a7ad"}},We={key:2,style:{color:"#a7a7ad","font-size":"0.55rem","white-space":"nowrap"}},He={style:{display:"flex","flex-direction":"column",gap:"1rem","align-items":"center","justify-content":"center"}},Qe=["innerHTML"],Ye={key:1,style:{"text-align":"center",width:"70%","font-size":"1rem"}},Ge={style:{display:"flex","justify-content":"center",gap:"1rem","margin-top":"1rem"}},Je={style:{display:"flex","flex-direction":"column","align-items":"center",gap:"1rem"}},Ke={__name:"SearchBar",props:{queryFn:{type:Function},isNavigation:{type:Boolean,default:!1},dataTableRef:{type:Object,required:!0},customStyle:{type:Boolean,default:!1},isRefreshData:{type:Boolean,default:!1},title:{type:String,default:"Search"}},emits:["refresh","followed"],setup(m,{expose:J,emit:K}){const q=_e(),T=Ee(),i=t(!1),F=t(!1),D=we(),h=m,X=K;t(null);const b=t(!1),U=t(null),_=t([]),s=t({page:1,pageSize:10,totalPages:0,totalResults:0}),O=a=>{if(!a)return"";const e=new De;return e.addStyle("currency",[" Th"," M"," B"," T"]),`$ ${e.format(a,{style:"currency",precision:1})}`},Z=$(()=>_.value),k=t(""),B=t(""),S=t(!1),N=t(null),ee=a=>{b.value=a},M=()=>{C()},ae=a=>{U.value=a},oe=xe.debounce(async a=>{S.value=!0,k.value=a,N.value&&N.value.abort(),N.value=new AbortController;try{await C(!1,N.value.signal)}catch(e){e.name==="AbortError"?console.log("Request was aborted"):console.error("Search error:",e)}finally{S.value=!1}},300),te=()=>{F.value=!0,i.value=!1,setTimeout(()=>{F.value=!1},2e3)},C=async(a,e)=>{if(S.value=!0,h.queryFn){const g=a?s.value.page:1,x=a?10:s.value.page*10,u=await h.queryFn(g,x,ee,k.value,e);a?_.value=[..._.value,...u.data]:_.value=u.data,s.value=u.meta}S.value=!1},le=async()=>{b.value=!0,s.value.page<s.value.totalPages&&(s.value.page+=1,await C(!0)),b.value=!1};be(()=>{C()});const se=$(()=>h.dataTableRef),ne=(a,e)=>{h.isNavigation&&a.isFollowed?(T.defaultTab=e,D.push(`/company/${a._id}`)):h.isNavigation&&!a.isFollowed&&(i.value=!0,ae(a))},I=async(a,e)=>{var g,x;try{if(b.value=!0,a.isLoading=!0,a.isFollowed){T.defaultTab=e,D.push(`/company/${a._id}`),i.value=!1;return}q.info({title:"Info",content:"Following company...",duration:2500}),a.isLoading=!1,re(a._id),i.value=!1,X("followed"),b.value=!1,q.success({title:"Success",content:"Company followed",duration:2500}),se.value.refresh(),M()}catch(u){a.isLoading=!1,((g=u.response)==null?void 0:g.data.message)==="Token Error"?(B.value="You do not have enough credits to follow this company. <br/> <br/> Either adjust your followed companies or Value Triggers, or upgrade your plan for more credits.",i.value=!0):((x=u.response)==null?void 0:x.data.message)==="User already follows this company"?D.push(`/company/${a._id}`):u&&(i.value=!1,D.push(`/company/${a._id}`))}},re=a=>{_.value=_.value.map(e=>e._id===a?{...e,isFollowed:!0}:e)},W=$(()=>Z.value),ie=$(()=>h.isRefreshData);P(ie,a=>{a&&(s.value.pageSize=s.value.page*s.value.pageSize,s.value.page=1,M())}),P(k,a=>{oe(a)}),J({refresh:M});const z=t(!1),V=t(!1),w=t(!1),v=t(null),ue=()=>{V.value=!0,z.value=!0},ce=()=>{V.value=!1,w.value||E()},de=()=>{var a,e;v.value&&clearTimeout(v.value),w.value=!0,z.value||(z.value=!0,(e=(a=H.value)==null?void 0:a.inputEl)==null||e.focus())},pe=()=>{w.value=!1,E()},fe=()=>{v.value&&clearTimeout(v.value),w.value=!0},ve=()=>{w.value=!1,E()},E=()=>{v.value&&clearTimeout(v.value),v.value=setTimeout(()=>{!V.value&&!w.value&&(z.value=!1)},150)},H=t(null);return P(()=>T.refreshSearchData,async a=>{a&&(s.value.page=1,await C(!1),T.setRefreshSearchData(!1))}),(a,e)=>{const g=Be,x=Ne,u=Re,R=$e,ge=Le,ye=Me,me=Ie,Q=he;return l(),d(G,null,[c(me,{show:z.value,"show-arrow":!1,ref:"popover",style:{height:"100%","margin-top":"-0.5px","border-radius":"0 0 10px 10px",padding:"0px 0","box-shadow":"0 3px 6px -4px rgba(0, 0, 0, .12), 0 6px 16px 0 rgba(0, 0, 0, .08), 0 9px 28px 8px rgba(0, 0, 0, .05) !important",overflow:"hidden",width:"100%"},placement:"bottom",onMouseenter:fe,onMouseleave:ve},{trigger:r(()=>[c(ye,{ref_key:"inputRef",ref:H,placeholder:m.title,size:"large",class:"paragraph-16-regular",style:{position:"relative","z-index":"1","border-radius":"50px"},value:k.value,"onUpdate:value":e[0]||(e[0]=o=>k.value=o),onFocus:ue,onBlur:ce,onMouseenter:de,onMouseleave:pe},{prefix:r(()=>[c(p(L),{component:p(ke),size:"22"},null,8,["component"])]),_:1},8,["placeholder","value"])]),default:r(()=>[c(ge,{style:{"max-height":"380px",width:"100%"},distance:10,onLoad:le},{default:r(()=>[n("div",Pe,[S.value?(l(),f(g,{key:0,size:"small",style:{display:"flex","justify-content":"center","padding-left":"1rem"}})):W.value.length===0?(l(),f(x,{key:1,description:"You can't find anything",style:{padding:"2rem 3rem",width:"100%"}})):y("",!0),(l(!0),d(G,null,Se(W.value,o=>(l(),d("div",{key:o._id,class:"item-container"},[n("div",{style:{display:"flex",gap:"10px","align-items":"center",padding:"0 1rem"},onClick:Y=>m.isNavigation?ne(o,"Business Overview"):I(o,"Business Overview")},[n("div",null,[o.logo_url?(l(),f(u,{key:0,round:"",size:"small",src:o.logo_url,onError:Y=>o.logo_url=null},null,8,["src","onError"])):y("",!0),o.logo_url?y("",!0):(l(),f(p(L),{key:1,size:"20",component:p(Ce)},null,8,["component"]))]),n("div",je,[n("span",{style:ze([{"font-size":"14px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"},{width:m.isNavigation?"300px":(o.isFollowed,"270px")}])},A(o.name),5),m.isNavigation?(l(),d("div",qe,A(O(o.annual_revenue)),1)):y("",!0)])],8,Ae),m.isNavigation?y("",!0):(l(),d("div",Ue,[o.isLoading?(l(),f(g,{key:0,size:"10"})):y("",!0),n("div",Oe,A(O(o.annual_revenue)),1),!o.isFollowed&&!o.isLoading?(l(),f(R,{key:1,secondary:"",size:"small",text:"",rounded:"",color:"#1A9C4D",onClick:Y=>I(o,"business overview")},{default:r(()=>[c(p(L),{size:"18",component:p(Te)},null,8,["component"])]),_:2},1032,["onClick"])):o.isLoading?y("",!0):(l(),d("div",We," Followed "))]))]))),128))])]),_:1})]),_:1},8,["show"]),c(Q,{isVisible:i.value,modalTitle:"",modalType:"customize",formInputs:[],"onUpdate:isVisible":e[4]||(e[4]=o=>i.value=o)},{default:r(()=>[n("div",He,[B.value?(l(),d("div",{key:0,innerHTML:B.value,style:{"text-align":"center",width:"85%","font-size":"1rem"}},null,8,Qe)):(l(),d("div",Ye," Would you like to activate a Research Agent for this company? ")),n("div",Ge,[c(R,{secondary:"",onClick:e[1]||(e[1]=o=>i.value=!1),style:{width:"100%","background-color":"#9e9e9e",color:"#fff"},round:"",class:"paragraph-16-regular"},{default:r(()=>e[6]||(e[6]=[j(" Cancel ")])),_:1}),B.value?(l(),f(R,{key:1,secondary:"",onClick:e[3]||(e[3]=o=>te()),size:"medium",style:{width:"100%"},round:"",color:"#1A9C4D",class:"paragraph-16-regular"},{default:r(()=>e[8]||(e[8]=[j(" Upgrade Plan ")])),_:1})):(l(),f(R,{key:0,secondary:"",onClick:e[2]||(e[2]=o=>I(U.value,"business overview")),style:{width:"100%","background-color":"#1a9c4d",color:"#fff"},round:"",color:"#1A9C4D",class:"paragraph-16-regular"},{default:r(()=>e[7]||(e[7]=[j(" Activate ")])),_:1}))])])]),_:1},8,["isVisible"]),c(Q,{isVisible:F.value,modalTitle:"",modalType:"customize",formInputs:[],"onUpdate:isVisible":e[5]||(e[5]=o=>F.value=o)},{default:r(()=>[n("div",Je,[c(p(L),{component:p(Fe),size:"150",color:"#1A9C4D"},null,8,["component"]),e[9]||(e[9]=n("div",{style:{"text-align":"center","font-size":"1.2rem"}},[n("p",null,"We've received your request! We will be in touch within 24 hours. Thank you!")],-1))])]),_:1},8,["isVisible"])],64)}}},aa=Ve(Ke,[["__scopeId","data-v-16f2d6ef"]]);export{aa as _};
