import{_ as U}from"./DataTable-RgBcQQQR.js";import{r as d,c as O,S as M,w as P,o as V,T as Y,b as Z,k as q,i as e,g as i,f,t as v,h,N as T,U as W,p as $,z as H,W as K,X,Y as G,Z as Q}from"./vendor-B24ldFEr.js";import{f as L}from"./formatter-DDo20qiT.js";import{_ as ee,u as k}from"./index-BUXYj-sS.js";const te={class:"container"},ae={class:"top-container"},oe={style:{display:"flex","justify-content":"space-between","align-items":"center"}},se={class:"chart-scroll-container"},le={class:"chart-container"},re={class:"right-top"},ne={style:{display:"flex","justify-content":"space-between",height:"100%"}},ie={style:{display:"flex","flex-direction":"column","justify-content":"space-between",height:"100%"}},ce={style:{display:"flex","flex-direction":"column",gap:"0.5rem"}},de={class:"header-semibold-xl",style:{color:"var(--text-color)"}},pe={class:"paragraph-14-regular text-grey"},ue={style:{display:"flex"}},fe={class:"paragraph-14-regular",style:{display:"flex","align-items":"center",gap:"0.5rem"}},he={class:"right-top"},ye={style:{display:"flex","justify-content":"space-between",height:"100%"}},ve={style:{display:"flex","flex-direction":"column","justify-content":"space-between",height:"100%"}},ge={style:{display:"flex","flex-direction":"column",gap:"0.5rem"}},me={class:"header-semibold-xl",style:{color:"var(--text-color)"}},_e={class:"paragraph-14-regular text-grey"},be={style:{display:"flex"}},xe={class:"paragraph-14-regular",style:{display:"flex","align-items":"center",gap:"0.5rem"}},we={class:"bottom-container"},ke={__name:"index",setup(Ce){const F=d(null),_=d(!1),b=d(!1),C=d(0),E=d(0),p=d(null),N=d(null);let y=null;const x=d({}),w=()=>{b.value=window.innerWidth<1240,y&&S()},n=d("week"),J=[{label:"Weekly",value:"week"},{label:"Monthly",value:"month"},{label:"Yearly",value:"year"}],R=async()=>{try{_.value=!0;const o=await k().get(`/dashboard/expense-logs?period=${n.value}`);p.value=o.data,o.data.categories&&Array.isArray(o.data.categories)&&(x.value={},o.data.categories.forEach(t=>{x.value[t.id]=t.name})),S()}catch(o){console.error("Error fetching chart data:",o)}finally{_.value=!1}},z=()=>{if(!p.value)return{labels:[],datasets:[]};const o=a=>{if(a.split("/").length===2){const[c,u]=a.split("/");return`${["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(c)-1]} ${u}`}else{const[c,u,g]=a.split("/"),A=new Date(`${g}-${u}-${c}`);return`${c} ${["January","February","March","April","May","June","July","August","September","October","November","December"][A.getMonth()]} ${g}`}},t=p.value.data.map(a=>o(a.date)),s=new Set;p.value.data.forEach(a=>{a.categories&&Object.keys(a.categories).forEach(c=>{c!=="total"&&s.add(c)})});const r=["#1a9c4d","#1890ff","#ff6b6b","#ffc107","#9c27b0","#607d8b","#795548","#009688","#673ab7","#3f51b5","#e91e63","#f44336"],l=Array.from(s).map((a,c)=>{const u=c%r.length,g=p.value.data.map(m=>m.categories&&m.categories[a]?m.categories[a]:0);return{label:x.value[a]||`Category ${a.substring(a.length-5)}`,data:g,fill:!1,borderColor:r[u],tension:.1,pointBackgroundColor:r[u],pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6,pointHoverBackgroundColor:r[u],pointHoverBorderColor:"#fff",pointHoverBorderWidth:2}});return l.length>0&&l.push({label:"Total",data:p.value.data.map(a=>a.total),fill:!1,borderColor:"#000000",borderWidth:2,tension:.1,pointBackgroundColor:"#000000",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:4,pointHoverRadius:6,pointHoverBackgroundColor:"#000000",pointHoverBorderColor:"#fff",pointHoverBorderWidth:2}),{labels:t,datasets:l}},j=o=>{checkedRowKeysRef.value=o},I=O(()=>[{title:"ID",key:"id",width:100},{title:"User ID",key:"userId",width:100},{title:"Title",key:"title",width:"30%"},{title:"Body",key:"body"},{title:"Action",key:"action",width:"7%",render(o){return M("div",{style:{display:"flex",gap:"8px"}},[M("button",{class:"paragraph-11-regular",style:{color:"white",backgroundColor:"#1890ff",border:"none",padding:"4px 8px",borderRadius:"4px",cursor:"pointer"},onClick:()=>handleEdit(o)},"Edit")])}}]),B=async(o,t,s)=>{try{typeof s=="function"&&s(!0);const l=(await k().get("/posts")).data.map(a=>({id:a.id,userId:a.userId,title:a.title,body:a.body}));return{data:l,meta:{page:1,pageSize:l.length,totalPages:1,totalResults:l.length}}}catch(r){return typeof s=="function"&&s(!1),console.error("Error fetching companies:",r),{data:[],meta:{page:1,pageSize:0,totalPages:0,totalResults:0}}}finally{typeof s=="function"&&s(!1)}},D=async()=>{try{const o=await k().get(`/dashboard/expense-data?period=${n.value}`);C.value=o.data.totalExpense,E.value=o.data.trend}catch(o){console.log(o)}},S=()=>{const o=N.value.getContext("2d");y&&y.destroy();let t={labels:[],datasets:[]};p.value?t=z():n.value==="week"?t={labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"No Data",data:[0,0,0,0,0,0,0],fill:!1,borderColor:"#1a9c4d",tension:.1}]}:n.value==="month"?t={labels:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[{label:"No Data",data:[0,0,0,0,0,0,0,0,0,0,0,0],fill:!1,borderColor:"#1a9c4d",tension:.1}]}:t={labels:["2019","2020","2021","2022","2023"],datasets:[{label:"No Data",data:[0,0,0,0,0],fill:!1,borderColor:"#1a9c4d",tension:.1}]},n.value==="week"||n.value;const s=b.value;y=new K(o,{type:"line",data:{labels:t.labels,datasets:t.datasets},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{display:!0,color:"rgba(0, 0, 0, 0.1)"}},x:{grid:{display:!1}}},plugins:{legend:{display:!0,position:"bottom",align:"start",labels:{usePointStyle:!0,pointStyle:"circle",padding:s?10:15,boxWidth:s?8:10,font:{size:s?10:12}},maxWidth:s?800:300,maxHeight:s?400:200},tooltip:{callbacks:{label:function(r){let l=r.dataset.label||"";return l&&(l+=": "),l+="$"+r.parsed.y.toFixed(2),l}}}}}})};return P(n,()=>{R(),D()}),V(()=>{w(),window.addEventListener("resize",w),B(),R(),D()}),Y(()=>{window.removeEventListener("resize",w),y&&y.destroy()}),(o,t)=>{const s=X,r=G,l=Q,a=U;return Z(),q("div",te,[e("div",ae,[i(l,{"x-gap":"20","y-gap":"20",cols:b.value?1:12,"item-responsive":""},{default:f(()=>[i(r,{class:"left-section",span:"8"},{default:f(()=>[e("div",oe,[t[1]||(t[1]=e("div",{class:"header-semibold",style:{color:"var(--text-color)"}},"Expense Management",-1)),i(s,{value:n.value,"onUpdate:value":t[0]||(t[0]=c=>n.value=c),options:J,style:{width:"150px"}},null,8,["value"])]),e("div",se,[e("div",le,[e("canvas",{ref_key:"chartRef",ref:N},null,512)])])]),_:1}),i(r,{span:"4",style:{display:"flex","flex-direction":"column",gap:"1rem"}},{default:f(()=>[e("div",re,[e("div",ne,[e("div",ie,[e("div",ce,[e("div",de,v(h(L)(C.value,"Rp",0)),1),t[2]||(t[2]=e("div",{class:"paragraph-14-semibold",style:{color:"var(--text-color)"}}," Total Expenses ",-1)),e("div",pe,"This "+v(n.value),1)]),e("div",ue,[e("div",fe,[i(h(T),{color:"#005F97"},{default:f(()=>[i(h(W))]),_:1}),$(" 2% more than last "+v(n.value),1)])])]),e("div",null,[i(h(H),{src:"/book-ic.svg",width:"70",height:"70","preview-disabled":""})])])]),e("div",he,[e("div",ye,[e("div",ve,[e("div",ge,[e("div",me,"+"+v(E.value.toFixed(2))+"%",1),t[3]||(t[3]=e("div",{class:"paragraph-14-semibold",style:{color:"var(--text-color)"}}," Expense Trend ",-1)),e("div",_e,"vs Last "+v(n.value),1)]),e("div",be,[e("div",xe,[i(h(T),{color:"#005F97"},{default:f(()=>[i(h(W))]),_:1}),$(" 2% more than last "+v(n.value),1)])])]),e("div",null,[i(h(H),{src:"/arrow-ic-ic.svg",width:"60",height:"60","preview-disabled":""})])])])]),_:1})]),_:1},8,["cols"])]),e("div",we,[i(l,{"x-gap":"20","y-gap":"20",cols:"1","item-responsive":""},{default:f(()=>[i(r,{class:"left-section"},{default:f(()=>[t[4]||(t[4]=e("div",{class:"header-semibold",style:{color:"var(--text-color)",padding:"1rem 0"}},"Recent Activity",-1)),i(a,{class:"table",queryFn:B,columns:I.value,loading:_.value,useCheckbox:!0,"onUpdate:selectedRows":j,pagination:!1,ref_key:"dataTableRef",ref:F},null,8,["columns","loading"])]),_:1})]),_:1})])])}}},De=ee(ke,[["__scopeId","data-v-5f39076f"]]);export{De as default};
